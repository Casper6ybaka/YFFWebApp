@model DatabasenWebApp.Models.UserModel
@{
    ViewBag.CurrentUser = Context.Request.Cookies["RememberMe"];
    ViewBag.IsLoggedIn = false;

    if (!string.IsNullOrEmpty(ViewBag.CurrentUser))
    {
        ViewBag.IsLoggedIn = true;

        Context.Response.Cookies.Append("RememberMe", "", new CookieOptions
                {
                    Expires = DateTimeOffset.UtcNow.AddDays(-1)
                });
    }
}
<div>
    <h4>Login Successful!</h4>
    <hr />
    <dl class="row">
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Id)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Id)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.UserName)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.UserName)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Password)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Password)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Bio)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Bio)
        </dd>
    </dl>
</div>
<script>
    function getCookieValue(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return null;
    }

    const currentUser = getCookieValue("RememberMe");
    const isLoggedIn = currentUser !== null;

    if (!isLoggedIn) {
        sessionStorage.removeItem("refreshedAfterLogin");
    }

    if (isLoggedIn && sessionStorage.getItem("refreshedAfterLogin") !== "true") {
        sessionStorage.setItem("refreshedAfterLogin", "true");
        location.reload(); // Only refresh once per login
    }
</script>

<div>
    @Html.ActionLink("Edit", "EditPage", new { /* id = Model.PrimaryKey */ }) |
    <a asp-action="Index">Back to Login</a>
</div>


